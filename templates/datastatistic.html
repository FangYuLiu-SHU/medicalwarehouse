<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>test</title>
    <link rel="stylesheet" href="../static/layui/css/layui.css" />
    <link rel="stylesheet" href="../static/css/style.css" />
    <style>
      .layui-form-label{
        width: 110px!important;
        font-size: 14px;
      }
      .layui-input-block{
        min-height: 50px!important;
        margin-bottom: 10px;
      }
      .layui-select{
        height: 35px;
      }
    </style>
  </head>
  <body>
      <div class="layui-body" style="left: 0">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 10px;">
          <legend>医疗数据统计分析</legend>
               <div style="text-align:right;"><a href="http://127.0.0.1:5000/statistic_detail" style="color:red;font-size:10px;">详细请点击</a></div>
        </fieldset>
        <div id="container1" style="width:100%;height: 85%">
          <div id="symptom_ana" style="width: 34%; height: 100%;float: left">症状统计</div>
          <div id="sex_ana" style="width: 33%; height: 50%;float: left">性别分布</div>
            <div id="age_ana" style="width: 33%; height: 50%;float: left">年龄分布</div>
            <div id="eGFR_ana" style="width: 33%; height: 50%;float: left">eGFR值分布</div>
          <div id="sc_ana" style="width: 33%; height: 50%;float: left">sc_value分布</div>
        </div>

    </div>
      <script src="../static/layui/layui.js"></script>
      <script type="text/javascript" src="/static/js/echarts.js"></script>
      <script type="text/javascript" src="/static/js/function.js"></script>
      <script type="text/javascript">
          var returndata={{data_json|tojson}};
        returndata=JSON.parse(returndata);
       var age_bins=[]
        for(var i=0;i<=returndata.age_distribute.bins.length;i++){
            if(i===returndata.age_distribute.bins.length){
                age_bins.push(returndata.age_distribute.bins[i-1]+"~")
            }else {
                age_bins.push((returndata.age_distribute.bins[i]) + "~" + (returndata.age_distribute.bins[i]+10))
            }

        }
        var sc_bins=[]
        for(var j=0;j<returndata.sc_distribute.bins.length;j++){
            if(j===returndata.sc_distribute.bins.length-1){
                sc_bins.push(returndata.sc_distribute.bins[j]+"~")
            }else {
                sc_bins.push((returndata.sc_distribute.bins[j]) + "~" + returndata.sc_distribute.bins[j+1])
            }

        }
        var eGFR_bins=[]
        for(var k=0;k<returndata.eGFR_distribute.bins.length;k++){
            if(k===returndata.eGFR_distribute.bins.length-1){
                eGFR_bins.push(returndata.eGFR_distribute.bins[k]+"~")
            }else {
                eGFR_bins.push((returndata.eGFR_distribute.bins[k]) + "~" + (returndata.eGFR_distribute.bins[k+1]))
            }

        }
        // document.write(sc_bins)
        var yMax = 150;
        var dataShadow = [];
          var eGFR_dom = document.getElementById('eGFR_ana');
        var eGFR_chart = echarts.init(eGFR_dom);
        var eGFR_option= {
                title: {
              text: 'eGFR值分布',
              left: 'center'
          },
             tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c}人 '
        },
            xAxis: {
                data: eGFR_bins,
                axisLabel: {
                    inside: false,
                    textStyle: {
                        color: '#120d0d'
                    }
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
                z: 10
            },
            yAxis: {
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    textStyle: {
                        color: '#999'
                    }
                }
            },
            dataZoom: [
                {
                    type: 'inside'
                }
            ],
            series: [
                {
                	name: 'eGFR值段：',
                    type: 'bar',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#a0020d'},
                                {offset: 0.5, color: '#be010e'},
                                {offset: 1, color: '#be010e'}
                            ]
                        )
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [
                                    {offset: 0, color: '#037ea3'},
                                    {offset: 0.7, color: '#0091ab'},
                                    {offset: 1, color: '#0571ae'}
                                ]
                            )
                        }
                    },
                    data: returndata.eGFR_distribute.num
                }
            ]


        };
        eGFR_chart.setOption(eGFR_option);
        var sc_dom = document.getElementById('sc_ana');
        var sc_chart = echarts.init(sc_dom);
        var sc_option= {
                title: {
              text: '血肌酐值分布',
              left: 'center'
          },
             tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c}人 '
        },
            xAxis: {
                data: sc_bins,
                axisLabel: {
                    inside: false,
                    textStyle: {
                        color: '#120d0d'
                    }
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
                z: 10
            },
            yAxis: {
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    textStyle: {
                        color: '#999'
                    }
                }
            },
            dataZoom: [
                {
                    type: 'inside'
                }
            ],
            series: [
                {
                	name: '血肌酐值段：',
                    type: 'bar',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#a0020d'},
                                {offset: 0.5, color: '#be010e'},
                                {offset: 1, color: '#be010e'}
                            ]
                        )
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [
                                    {offset: 0, color: '#037ea3'},
                                    {offset: 0.7, color: '#0091ab'},
                                    {offset: 1, color: '#0571ae'}
                                ]
                            )
                        }
                    },
                    data: returndata.sc_distribute.num
                }
            ]


        };
        sc_chart.setOption(sc_option);
        var age_dom = document.getElementById('age_ana');
        var age_chart = echarts.init(age_dom);
        var age_option={
            title: {
              text: '患者年龄分布',
              left: 'center'
          },
            tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c}人 '
        },
            xAxis: {
                data: age_bins,
                axisLabel: {
                    inside: false,
                    textStyle: {
                        color: '#120d0d'
                    }
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
                z: 10
            },
            yAxis: {
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    textStyle: {
                        color: '#999'
                    }
                }
            },
            dataZoom: [
                {
                    type: 'inside'
                }
            ],
            series: [
                {
                	name: '年龄段：',
                    type: 'bar',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#a0020d'},
                                {offset: 0.5, color: '#be010e'},
                                {offset: 1, color: '#be010e'}
                            ]
                        )
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [
                                    {offset: 0, color: '#037ea3'},
                                    {offset: 0.7, color: '#0091ab'},
                                    {offset: 1, color: '#0571ae'}
                                ]
                            )
                        }
                    },
                    data: returndata.age_distribute.num
                }
            ]

                };
        age_chart.setOption(age_option);

        var sex_dom = document.getElementById('sex_ana');
        var sex_chart = echarts.init(sex_dom);
        var sex_option={
          title: {
              text: '患者性别分布',
              left: 'center'
          },
          tooltip: {
              trigger: 'item'
          },
          legend: {
              orient: 'vertical',
              left: 'left',
          },
          series: [
              {
                  // name: '访问来源',
                  type: 'pie',
                  radius: '60%',
                  data: [
                      {value: returndata.num_male, name: '男性'},
                      {value:returndata.num_female, name: '女性'},
                  ],
                  emphasis: {
                      itemStyle: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0,0,0,0.5)'
                      }
                  }
              }
          ]
        };
        sex_chart.setOption(sex_option)

        var symptom_dom = document.getElementById('symptom_ana');
        var symptom_chart = echarts.init(symptom_dom);
        var symptom_option={
          title: {
              text: '患者症状分布',
              left: 'center'
          },
          tooltip: {
              trigger: 'item'
          },
          legend: {
              orient: 'vertical',
              left: 'left',
          },
          series: [
              {
                  type: 'pie',
                  radius: '60%',
                  data: [
                      {value: returndata.num_pos, name: '肾阳虚'},
                      {value: returndata.num_neg, name: '肾阴虚'},
                  ],
                  emphasis: {
                      itemStyle: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0,0,0,0.5)'
                      }
                  }
              }
          ]
        };
        symptom_chart.setOption(symptom_option);
      </script>

  </body>

</html>
